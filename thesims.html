<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>js-dos Diablo I</title>
    <style>
        html, body {
            height: 100%;
        }

        #dos {
            width: 100%;
            height: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://v8.js-dos.com/latest/js-dos.css">
    <script src="https://v8.js-dos.com/latest/js-dos.js"></script>
</head>
<body>

<div id="dos"></div>

<script>
    const simsConfig = `
[sdl]
autolock=false
mouse_emulation=integration

[dosbox]
title=Windows 98
memsize=256

[video]
vmemsize=16
vesa modelist width limit=0
vesa modelist height limit=0

[dos]
ver=7.1
hard drive data rate limit=0
floppy drive data rate limit=0

[cpu]
cputype=pentium_mmx
core=auto
integration device=true

[sblaster]
sbtype=sb16vibra

[fdc, primary]
int13fakev86io=true

[ide, primary]
int13fakeio=true
int13fakev86io=true

[ide, secondary]
int13fakeio=true
int13fakev86io=true
cd-rom insertion delay=4000

[render]
scaler=none

[autoexec]
echo off
mount c .
imgmount 2 cdrom.iso -t cdrom
boot c:
`;

    async function fetchAndMountISO(url, elementId) {
        const response = await fetch(url);
        const blob = await response.blob();
        const file = new File([blob], "cdrom.iso");

        const mountISO = async () => {
            await Dos(document.getElementById(elementId), {
                dosboxConf: simsConfig,
                onrun: (fs) => {
                    fs.createFile("/cdrom.iso", file);
                }
            });
        };

        mountISO();
    }

    fetchAndMountISO('http://caseybement.com/thesims.iso', 'dos');
</script>

</body>
</html>
